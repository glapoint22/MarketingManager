<div *ngIf="items">
    <!-- Temp Select -->
    <select #tmpSelect style="padding-left: 5px; position: absolute; visibility: hidden">
        <option [innerHtml]="selectedSearchOption"></option>
    </select>

    <!-- Search -->
    <div class="search-container">
        <select [style.width.px]="tmpSelect.offsetWidth" [(ngModel)]="selectedSearchOption" name="searchOptions">
            <option *ngFor="let option of searchOptions" [ngValue]="option">{{option}}</option>
        </select>
        <i class="fas fa-search fa-sm"></i>
        <input #search type="text" class="search" (input)="onSearchChange($event.target.value)">
        <div (click)="clearText(search)">
            <i class="fas fa-times-circle fa-sm"></i>
        </div>
    </div>

    <!-- Grid -->
    <div *ngIf="items.length > 0" class="grid" [style.height.px]="gridHeight">
        <!-- Header -->
        <div class="header">
            Categories

            <!-- Header Icons -->
            <div (click)="deleteItem()" class="header-icon" title="Delete Category" [ngClass]="{'icon-disabled': !currentSelected || currentSelected.type != 'Category' || (currentSelected && !currentSelected.selected)}">
                <i class="fas fa-trash-alt"></i>
            </div>

            <div class="header-icon" title="New Category" (click)="addItem('Category')">
                <i class="fas fa-file-alt"></i>
            </div>

            <div class="header-icon" title="Collapse All" (click)="collapse()">
                <i class="fas fa-minus-square"></i>
            </div>
        </div>


        <div id="tier1" *ngFor="let tier1 of items; let i = index" style="position: relative">
            <input #tier1Checkbox [id]="'tier1Checkbox' + i" type="checkbox" (change)="onTier1CheckboxChange(i, tier1Checkbox)" [(ngModel)]="tier1.checked">
            <label [for]="'tier1Checkbox' + i"></label>
            <div (dblclick)="highlightName(tier1)" class="row" style="position: absolute; width: 98.58064516129032%" [ngClass]="{'selected': tier1.selected}" (click)="selectItem(tier1, i)">
                <div *ngIf="!tier1.isSettingName">{{tier1.name}}</div>
                <input #name (change)="setItemName(name.value)" id="name" onfocus="this.select()" *ngIf="tier1.isSettingName" type="text" class="input-name" [value]="tier1.name">
            </div>

            

            <div class="header max-height" style="margin-left: 22px">
                Niches

                <!-- Header Icons -->
                <div (click)="deleteItem()" class="header-icon" title="Delete Niche" [ngClass]="{'icon-disabled': !currentSelected || currentSelected.type != 'Niche' || currentSelected.categoryIndex != i || (currentSelected && !currentSelected.selected)}">
                    <i class="fas fa-trash-alt"></i>
                </div>

                <div class="header-icon" title="New Niche" (click)="addItem('Niche', i, tier1.id)">
                    <i class="fas fa-file-alt"></i>
                </div>
            </div>



            <div id="tier2" class="max-height" *ngFor="let tier2 of tier1.niches; let j = index" [ngClass]="{'max-height-expanded' : tier2Checkbox.checked}"
                (transitionend)="tier2TransitionEnd(i, tier1Checkbox)">
                <input #tier2Checkbox [id]="'tier2Checkbox_' + i + '_' + j" (change)="onTier2CheckboxChange(i, j, tier2Checkbox)" type="checkbox">
                <label [for]="'tier2Checkbox_' + i + '_' + j" style="margin-left: 22px"></label>
                <div (dblclick)="highlightName(tier2)" class="row" style="position: absolute; width: 97.16129032258065%" [ngClass]="{'selected': tier2.selected}" (click)="selectItem(tier2, i, j)">
                    <div *ngIf="!tier2.isSettingName">{{tier2.name}}</div>
                    <input #name (change)="setItemName(name.value)" id="name" onfocus="this.select()" *ngIf="tier2.isSettingName" type="text" class="input-name" [value]="tier2.name">
                </div>


                <div class="header max-height" style="margin-left: 44px">
                    Products

                    <!-- Header Icons -->
                    <div (click)="deleteItem()" class="header-icon" title="Delete Product" [ngClass]="{'icon-disabled': !currentSelected || currentSelected.type != 'Product' || currentSelected.nicheIndex != j || (currentSelected && !currentSelected.selected)}">
                        <i class="fas fa-trash-alt"></i>
                    </div>

                    <div class="header-icon" title="New Product" (click)="addItem('Product', i, tier1.id, j, tier2.id)">
                        <i class="fas fa-file-alt"></i>
                    </div>
                </div>
                <div id="tier3" class="max-height" *ngFor="let tier3 of tier2.products; let k = index" (transitionend)="tier3TransitionEnd(i, j, tier2Checkbox)">
                    <div (dblclick)="highlightName(tier3)" class="row" style="margin-left: 44px; width: 97.16129032258065%" [ngClass]="{'selected': tier3.selected}" (click)="selectItem(tier3, i, j, k)">
                        <div *ngIf="!tier3.isSettingName">{{tier3.name}}</div>
                        <input #name (change)="setItemName(name.value)" id="name" onfocus="this.select()" *ngIf="tier3.isSettingName" type="text" class="input-name" [value]="tier3.name">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="items.length == 0">
        <div class="no-results" [style.lineHeight.px]="gridHeight">
            No results found
        </div>
    </div>
</div>